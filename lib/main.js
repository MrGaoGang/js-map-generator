!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["map-generator"]=e():t["map-generator"]=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";t.exports=r(4)},function(t,e,r){"use strict";t.exports=r(3)},function(t,e,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,u,s=a(t),c=1;c<arguments.length;c++){for(var l in r=Object(arguments[c]))o.call(r,l)&&(s[l]=r[l]);if(n){u=n(r);for(var f=0;f<u.length;f++)i.call(r,u[f])&&(s[u[f]]=r[u[f]])}}return s}},function(t,e,r){"use strict";
/** @license React v17.0.2
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */r(2);var n=r(0),o=60103;if(e.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var i=Symbol.for;o=i("react.element"),e.Fragment=i("react.fragment")}var a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u=Object.prototype.hasOwnProperty,s={key:!0,ref:!0,__self:!0,__source:!0};function c(t,e,r){var n,i={},c=null,l=null;for(n in void 0!==r&&(c=""+r),void 0!==e.key&&(c=""+e.key),void 0!==e.ref&&(l=e.ref),e)u.call(e,n)&&!s.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===i[n]&&(i[n]=e[n]);return{$$typeof:o,type:t,key:c,ref:l,props:i,_owner:a.current}}e.jsx=c,e.jsxs=c},function(t,e,r){"use strict";
/** @license React v17.0.2
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n=r(2),o=60103,i=60106;e.Fragment=60107,e.StrictMode=60108,e.Profiler=60114;var a=60109,u=60110,s=60112;e.Suspense=60113;var c=60115,l=60116;if("function"==typeof Symbol&&Symbol.for){var f=Symbol.for;o=f("react.element"),i=f("react.portal"),e.Fragment=f("react.fragment"),e.StrictMode=f("react.strict_mode"),e.Profiler=f("react.profiler"),a=f("react.provider"),u=f("react.context"),s=f("react.forward_ref"),e.Suspense=f("react.suspense"),c=f("react.memo"),l=f("react.lazy")}var p="function"==typeof Symbol&&Symbol.iterator;function h(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function d(t,e,r){this.props=t,this.context=e,this.refs=v,this.updater=r||y}function m(){}function x(t,e,r){this.props=t,this.context=e,this.refs=v,this.updater=r||y}d.prototype.isReactComponent={},d.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(h(85));this.updater.enqueueSetState(this,t,e,"setState")},d.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},m.prototype=d.prototype;var g=x.prototype=new m;g.constructor=x,n(g,d.prototype),g.isPureReactComponent=!0;var b={current:null},_=Object.prototype.hasOwnProperty,M={key:!0,ref:!0,__self:!0,__source:!0};function w(t,e,r){var n,i={},a=null,u=null;if(null!=e)for(n in void 0!==e.ref&&(u=e.ref),void 0!==e.key&&(a=""+e.key),e)_.call(e,n)&&!M.hasOwnProperty(n)&&(i[n]=e[n]);var s=arguments.length-2;if(1===s)i.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(n in s=t.defaultProps)void 0===i[n]&&(i[n]=s[n]);return{$$typeof:o,type:t,key:a,ref:u,props:i,_owner:b.current}}function C(t){return"object"==typeof t&&null!==t&&t.$$typeof===o}var O=/\/+/g;function j(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function S(t,e,r,n,a){var u=typeof t;"undefined"!==u&&"boolean"!==u||(t=null);var s=!1;if(null===t)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case o:case i:s=!0}}if(s)return a=a(s=t),t=""===n?"."+j(s,0):n,Array.isArray(a)?(r="",null!=t&&(r=t.replace(O,"$&/")+"/"),S(a,e,r,"",(function(t){return t}))):null!=a&&(C(a)&&(a=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(O,"$&/")+"/")+t)),e.push(a)),1;if(s=0,n=""===n?".":n+":",Array.isArray(t))for(var c=0;c<t.length;c++){var l=n+j(u=t[c],c);s+=S(u,e,r,l,a)}else if("function"==typeof(l=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=p&&t[p]||t["@@iterator"])?t:null}(t)))for(t=l.call(t),c=0;!(u=t.next()).done;)s+=S(u=u.value,e,r,l=n+j(u,c++),a);else if("object"===u)throw e=""+t,Error(h(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return s}function k(t,e,r){if(null==t)return t;var n=[],o=0;return S(t,n,"","",(function(t){return e.call(r,t,o++)})),n}function R(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var E={current:null};function I(){var t=E.current;if(null===t)throw Error(h(321));return t}var P={ReactCurrentDispatcher:E,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:n};e.Children={map:k,forEach:function(t,e,r){k(t,(function(){e.apply(this,arguments)}),r)},count:function(t){var e=0;return k(t,(function(){e++})),e},toArray:function(t){return k(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error(h(143));return t}},e.Component=d,e.PureComponent=x,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,e.cloneElement=function(t,e,r){if(null==t)throw Error(h(267,t));var i=n({},t.props),a=t.key,u=t.ref,s=t._owner;if(null!=e){if(void 0!==e.ref&&(u=e.ref,s=b.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(l in e)_.call(e,l)&&!M.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==c?c[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){c=Array(l);for(var f=0;f<l;f++)c[f]=arguments[f+2];i.children=c}return{$$typeof:o,type:t.type,key:a,ref:u,props:i,_owner:s}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:u,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=w,e.createFactory=function(t){var e=w.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:s,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:l,_payload:{_status:-1,_result:t},_init:R}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return I().useCallback(t,e)},e.useContext=function(t,e){return I().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return I().useEffect(t,e)},e.useImperativeHandle=function(t,e,r){return I().useImperativeHandle(t,e,r)},e.useLayoutEffect=function(t,e){return I().useLayoutEffect(t,e)},e.useMemo=function(t,e){return I().useMemo(t,e)},e.useReducer=function(t,e,r){return I().useReducer(t,e,r)},e.useRef=function(t){return I().useRef(t)},e.useState=function(t){return I().useState(t)},e.version="17.0.2"},function(t,e,r){"use strict";CanvasRenderingContext2D.prototype.fillTextVertical=function(t,e,r){var n=this,o=(n.canvas,t.split("")),i=o.map((function(t){return n.measureText(t).width})),a=n.textAlign,u=n.textBaseline;"left"===a?e+=Math.max.apply(null,i)/2:"right"===a&&(e-=Math.max.apply(null,i)/2),"bottom"===u||"alphabetic"===u||"ideographic"===u?r-=i[0]/2:"top"!==u&&"hanging"!==u||(r+=i[0]/2),n.textAlign="center",n.textBaseline="middle",o.forEach((function(o,a){var u=i[a];o.charCodeAt(0)<=256?(n.translate(e,r),n.rotate(90*Math.PI/180),n.translate(-e,-r)):a>0&&t.charCodeAt(a-1)<256&&(r+=i[a-1]/2),n.fillText(o,e,r),n.setTransform(1,0,0,1,0,0);u=i[a];r+=u})),n.textAlign=a,n.textBaseline=u}},function(t,e,r){"use strict";r.r(e),r.d(e,"MapItem",(function(){return a})),r.d(e,"ItemGridSize",(function(){return u})),r.d(e,"ItemGridValue",(function(){return s})),r.d(e,"Point",(function(){return c})),r.d(e,"getGridCount",(function(){return l})),r.d(e,"MainMap",(function(){return g})),r.d(e,"DetailMap",(function(){return O}));var n=r(1),o=r(0),i=r.n(o),a=function(t,e){this.value=t,this.color=e},u=10,s=10,c=function(t,e){this.x=t,this.y=e};function l(t){return Math.floor(t/s)}function f(t){return Math.round(Math.random()*t)}var p=function(){function t(t,e,r,n){this.value=t,this.name=e,this.xCount=r,this.yCount=n,this.frontierCount=0,this.frontiers={},this.color="white",this._loopCount=0}return t.prototype._getContiguous=function(t){return[[0,1],[0,-1],[1,0],[-1,0]].map((function(e){return{x:t.x+e[0],y:t.y+e[1]}}))},t.prototype.changeMapItem=function(t,e,r){var n=t[e][r];n&&(n.value=this.value,n.color=this.color)},t.prototype.getMapInfo=function(){var t=Object.keys(this.frontiers),e=[],r=[];return t.forEach((function(t){var n=t.split(":");e.push(parseInt(n[0])),r.push(parseInt(n[1]))})),{x:e,y:r}},t.prototype.getCenterMap=function(){var t=this.getMapInfo(),e=t.x.reduce((function(t,e){return t+e}),0),r=t.y.reduce((function(t,e){return t+e}),0);return{x:Math.floor(e/t.x.length),y:Math.floor(r/t.y.length)}},t.prototype.getSpaceMapEdge=function(t){for(var e=this.getCenterMap(),r=this._getContiguous(e)[f(3)],n=0;n<this.xCount;){if(n++,t[r.x][r.y]&&-1===t[r.x][r.y].value)return r;r=this._getContiguous(r)[f(3)]}return{x:-1,y:-1}},t.prototype.fill=function(t,e){var r=this;if(this._loopCount>=this.xCount*this.yCount*2/3)console.log("超出查询最大的次数");else{this._loopCount++,e.x>0&&e.y>0&&t[e.x][e.y]&&-1===t[e.x][e.y].value&&(this.frontierCount++,this.frontiers[e.x+":"+e.y]=!0,this.changeMapItem(t,e.x,e.y));for(var n=this._getContiguous({x:e.x,y:e.y}),o=n.filter((function(e){return!(e.x<0||e.y<0||e.x>=r.xCount||e.y>=r.yCount)&&(!t[e.x][e.y]||-1===t[e.x][e.y].value)})),i=0;i<o.length;i++){var a=o[i];this.changeMapItem(t,a.x,a.y),this.frontiers[a.x+":"+a.y]=!0,this.frontierCount++}if(this.frontierCount<this.value){var u=Object.keys(this.frontiers).length,s=f(this.frontierCount-1);if(-1!==s&&u>0){var c=Object.keys(this.frontiers)[s].split(":").map((function(t){return parseInt(t)}));this.fill(t,{x:c[0],y:c[1]})}else if(Object.keys(this.frontiers).length>0){c=Object.keys(this.frontiers)[f(Object.keys(this.frontiers).length)].split(":").map((function(t){return parseInt(t)}));this.fill(t,{x:c[0],y:c[1]})}else{var l=n;(c=l[f(l.length-1)])&&l.length>1&&this.fill(t,{x:c.x,y:c.y})}}}},t}();r(5);function h(t,e){for(var r=t.canvas.width,n=t.canvas.height,o=Math.floor(n/e),i=Math.floor(r/e),a=0;a<o;a++)t.beginPath(),t.moveTo(0,e*a-.5),t.lineTo(r,e*a-.5),t.strokeStyle="#ccc",t.stroke();for(var u=0;u<i;u++)t.beginPath(),t.moveTo(e*u,0),t.lineTo(e*u,n),t.strokeStyle="#ccc",t.stroke()}function y(t){var e,r;return t.layerX||0===t.layerX?(e=t.layerX,r=t.layerY):(t.offsetX||0===t.offsetX)&&(e=t.offsetX,r=t.offsetY),{x:e,y:r}}var v,d=(v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),m=function(){for(var t=Math.floor(16777216*Math.random()).toString(16);t.length<6;)t="0"+t;return"#"+t},x=10,g=function(t){function e(e){var r=t.call(this,e)||this;return r.draw=function(){for(var t=0;t<r.numXs;t++)for(var e=0;e<r.numYs;e++){var n=r.dataMap[t][e];n&&-1!==n.value&&r.drawGridTile(t,e,n.color)}for(var o=0;o<r.labelQueue.length;o++){var i=r.labelQueue[o];r.drawLabel(i)}},r.drawLabel=function(t){var e=t.center,n=t.name,o=t.textColor;r.ctx&&(r.ctx.fillStyle=o||"black",r.ctx.font="20px bold"),r.ctx.fillTextVertical(n,e.x*x,e.y*x)},r.initDataMap=function(t){var e=t.canvas.width,n=t.canvas.height,o=Math.floor(n/x),i=Math.floor(e/x);r.numYs=o,r.numXs=i;for(var a=0;a<r.numXs;a++){for(var u=[],s=0;s<r.numYs;s++)u.push({color:"white",value:-1,name:""});r.dataMap.push(u)}},r.registerListener=function(){var t;null===(t=r.canvasRef.current)||void 0===t||t.addEventListener("click",(function(t){var e=y(t),n={x:Math.floor(e.x/x),y:Math.floor(e.y/x)},o=r.getEventInWhereMap(n);if(-1!==o.index){var i=r.labelQueue[o.index];r.props.callback&&r.props.callback(i)}}))},r.canvasRef=i.a.createRef(),r.numXs=0,r.numYs=0,r.dataMap=[],r.ctx=null,r.labelQueue=[],r.state={selectMapInfo:{}},r}return d(e,t),e.prototype.drawGridTile=function(t,e,r){var n=t*x,o=e*x;this.ctx&&(this.ctx.fillStyle=r||"transparent",this.ctx.clearRect(n,o,x,x),this.ctx.fillRect(n,o,x,x))},e.prototype.changeMapItem=function(t,e){var r=this.dataMap[t][e];r&&(r.value=1,r.color="red")},e.prototype.getEventInWhereMap=function(t){for(var e=0;e<this.labelQueue.length;e++){var r=this.labelQueue[e];if(r.positions[t.x+":"+t.y])return{id:r.id,index:e}}return{index:-1,id:""}},e.prototype.componentDidMount=function(){var t=this,e=this.canvasRef.current.getContext("2d");if(this.ctx=e,this.ctx){var r=this.props,n=r.mapColorRandom,o=r.gridSize;x=o||10,this.initDataMap(this.ctx),this.registerListener(),h(this.ctx,x),this.props.mapData&&this.props.mapData.forEach((function(e,r){var o=new p(e.value,e.name,t.numXs,t.numYs);o.color=n?m():e.color||"",o.fill(t.dataMap,new c(Math.floor(t.numXs/2),Math.floor(t.numYs/2))),t.labelQueue.push({center:o.getCenterMap(),name:o.name,id:o.name,color:o.color,positions:o.frontiers,textColor:m(),index:r,children:e.children||[]})})),this.draw()}},e.prototype.render=function(){var t=this.props,e=t.mapWidth,r=void 0===e?1e3:e,o=t.mapHeight,i=void 0===o?500:o;return Object(n.jsx)("canvas",{ref:this.canvasRef,width:r,height:i},void 0)},e}(o.Component),b=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function _(t){return Math.round(Math.random()*t)}var M=function(t){function e(e,r,n,o){return t.call(this,e,r,n,o)||this}return b(e,t),e.prototype.fillReaming=function(t){for(var e=0;e<this.xCount;e++)for(var r=0;r<this.yCount;r++)0===t[e][r].value&&this.changeMapItem(t,e,r)},e.prototype.fillWithRow=function(t,e){var r=0;if("average"===e)for(var n=0;n<this.yCount;n++)for(var o=0;o<this.xCount;o++)0===t[o][n].value&&r<=this.value&&(this.changeMapItem(t,o,n),r++);else for(o=0;o<this.xCount;o++)for(n=0;n<this.yCount;n++)0===t[o][n].value&&r<=this.value&&(this.changeMapItem(t,o,n),r++)},e.prototype.fill=function(t,e){var r=this;if(this._loopCount>=this.xCount*this.yCount*2/3)console.log("inner超出查询最大的次数");else{this._loopCount++,e.x>0&&e.y>0&&t[e.x][e.y]&&0===t[e.x][e.y].value&&(this.frontiers[e.x+":"+e.y]=!0,this.changeMapItem(t,e.x,e.y),this.frontierCount++);for(var n=this._getContiguous({x:e.x,y:e.y}).filter((function(e){return!(e.x<0||e.y<0||e.x>=r.xCount||e.y>=r.yCount)&&(!t[e.x][e.y]||!(-1===t[e.x][e.y].value||t[e.x][e.y].value>0))})),o=0;o<n.length;o++){var i=n[o];this.changeMapItem(t,i.x,i.y),this.frontiers[i.x+":"+i.y]=!0,this.frontierCount++}if(this.frontierCount<this.value){var a=Object.keys(this.frontiers).length,u=_(a-1);if(-1!==u&&a>0){var s=Object.keys(this.frontiers)[u].split(":").map((function(t){return parseInt(t)}));this.fill(t,{x:s[0],y:s[1]})}else if(Object.keys(this.frontiers).length>0){s=Object.keys(this.frontiers)[_(Object.keys(this.frontiers).length)].split(":").map((function(t){return parseInt(t)}));this.fill(t,{x:s[0],y:s[1]})}else{var c=this._getContiguous(e);(s=c[_(c.length-1)])&&c.length>1&&this.fill(t,{x:s.x,y:s.y})}}}},e}(p),w=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C=10,O=function(t){function e(e){var r=t.call(this,e)||this;return r.draw=function(){for(var t=0;t<r.numXs;t++)for(var e=0;e<r.numYs;e++){var n=r.dataMap[t][e];n&&-1!==n.value&&r.drawGridTile(t,e,n.color)}for(var o=0;o<r.labelQueue.length;o++){var i=r.labelQueue[o];r.drawLabel(i)}},r.drawLabel=function(t){var e=t.center,n=t.name,o=t.color;r.ctx&&(r.ctx.fillStyle=o||"black",r.ctx.font="20px bold"),r.ctx.fillTextVertical(n,e.x*C,e.y*C)},r.initDataMap=function(){if(r.ctx){var t=r.ctx,e=r.props,n=e.positions,o=void 0===n?{}:n,i=e.color,a=void 0===i?"transparent":i,u=t.canvas.width,s=t.canvas.height,c=Math.floor(s/C),l=Math.floor(u/C);r.numYs=c,r.numXs=l;for(var f=0;f<r.numXs;f++){for(var p=[],h=0;h<r.numYs;h++)o[f+":"+h]&&p.push({color:a,value:1,name:""}),p.push({color:"transparent",value:-1,name:""});r.dataMap.push(p)}}},r.registerListener=function(){var t;null===(t=r.canvasRef.current)||void 0===t||t.addEventListener("click",(function(t){var e=y(t),n={x:Math.floor(e.x/C),y:Math.floor(e.y/C)};console.log(r.getEventInWhereMap(n),"====点击的区域====")}))},r.canvasRef=i.a.createRef(),r.ctx=null,r.numXs=0,r.numYs=0,r.dataMap=[],r.labelQueue=[],r}return w(e,t),e.prototype.drawGridTile=function(t,e,r){var n=t*C,o=e*C;this.ctx&&(this.ctx.fillStyle=r||"transparent",this.ctx.fillRect(n,o,C,C))},e.prototype.clearGrid=function(){for(var t=0;t<this.numXs;t++)for(var e=0;e<this.numYs;e++){var r=t*C,n=e*C;this.ctx&&this.ctx.clearRect(r,n,C,C)}this.props.showLine&&this.ctx&&h(this.ctx,C)},e.prototype.clearMap=function(){for(var t=0;t<this.numXs;t++)for(var e=0;e<this.numYs;e++)this.dataMap[t][e].value=-1},e.prototype.componentWillUpdate=function(t){t.positions===this.props.positions&&t.color===this.props.color||(C=t.gridSize||10,this.updateMap(t),this.clearGrid(),this.draw())},e.prototype.updateMap=function(t){var e=this;if(t.center&&t.positions){var r=Math.floor(this.numXs/2),n=Math.floor(this.numYs/2),o=r-t.center.x,i=n-t.center.y;this.clearMap();for(var a=0;a<this.numXs;a++)for(var u=0;u<this.numYs;u++)t.positions[a+":"+u]&&(this.dataMap[a+o][u+i].value=0,this.dataMap[a+o][u+i].color=t.color)}var s=t.showType,l=t.mapColorRandom;"average"!==s&&"random-fill"!==s&&"average-vertical"!==s||(t.datas||[]).forEach((function(r,n){var o=new M(r.value,r.name,e.numXs,e.numYs);o.color=l?function(){for(var t=Math.floor(16777216*Math.random()).toString(16);t.length<6;)t="0"+t;return"#"+t}():r.color||"","average"===s||"average-vertical"===s?o.fillWithRow(e.dataMap,s):"random-fill"===t.showType&&(n===t.datas.length-1?o.fillReaming(e.dataMap):o.fill(e.dataMap,new c(Math.floor(e.numXs/2),Math.floor(e.numYs/2))))}))},e.prototype.getEventInWhereMap=function(t){for(var e=0;e<this.labelQueue.length;e++){var r=this.labelQueue[e];if(r.positions[t.x+":"+t.y])return r.id}return""},e.prototype.componentDidMount=function(){var t=this.canvasRef.current,e=this.props,r=e.showLine,n=e.gridSize,o=void 0===n?10:n,i=null==t?void 0:t.getContext("2d");C=o,i&&(this.ctx=i,this.initDataMap(),this.registerListener(),r&&h(i,C))},e.prototype.render=function(){var t=this.props,e=t.mapWidth,r=void 0===e?1e3:e,o=t.mapHeight,i=void 0===o?500:o;return Object(n.jsx)("canvas",{ref:this.canvasRef,width:r,height:i},void 0)},e}(o.Component)}])}));